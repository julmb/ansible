{% if dnsmasq.address is defined %}
listen-address = {{ dnsmasq.address }}
{% endif %}

no-hosts
addn-hosts = /etc/dnsmasq.hosts
expand-hosts

{% if dnsmasq.domain is defined %}
domain = {{ dnsmasq.domain }}
{% endif %}

{% if dnsmasq.cache is defined %}
cache-size = {{ dnsmasq.cache }}
{% endif %}

{% if dnsmasq.dhcp is defined %}
dhcp-range = {{ dnsmasq.dhcp.start }}, {{ dnsmasq.dhcp.end }}, {{ dnsmasq.dhcp.duration }}
dhcp-option = option:router, {{ dnsmasq.dhcp.gateway }}
dhcp-option = option:dns-server, {{ dnsmasq.dhcp.nameserver }}
{% for host, entry in dnsmasq.hosts.items() %}
{% if entry.mac is defined %}
dhcp-host = {{ host.split('.') | reverse | join('-') }}{{ ', ' + entry.mac }}{{ ', ' + entry.ip if entry.ip is defined }}
{% endif %}
{% endfor %}
{% endif %}
