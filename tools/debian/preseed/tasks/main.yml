# TODO: use temporary directory for this after development is done?
- name: directory
  ansible.builtin.file: { path: "{{ directory }}", state: directory }
- name: image
  ansible.builtin.get_url: { url: "{{ url }}{{ image }}", dest: "{{ directory }}{{ image }}" }
- name: preseed configuration
  ansible.builtin.copy: { src: preseed.cfg, dest: "{{ directory }}" }
- name: grub configuration
  ansible.builtin.copy: { src: grub.cfg, dest: "{{ directory }}" }
- name: iso
  ansible.builtin.command: |
    xorriso
    -boot_image any keep
    -indev {{ directory }}{{ image }}
    -outdev {{ directory }}{{ output }}
    -map {{ directory }}/preseed.cfg preseed.cfg
    -map {{ directory }}/grub.cfg boot/grub/grub.cfg
  args: { creates: "{{ directory }}{{ output }}" }
