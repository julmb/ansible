- name: package
  ansible.builtin.apt: { name: [docker.io, docker-compose] }
  when: ansible_os_family == "Debian"
- name: feature
  ansible.windows.win_feature: { name: Containers }
  register: feature
  when: ansible_os_family == "Windows"
- name: reboot
  ansible.windows.win_reboot:
  when: ansible_os_family == "Windows" and feature.reboot_required
- name: package
  win_chocolatey: { name: [docker-engine, docker-compose] }
  when: ansible_os_family == "Windows"
- name: configuration
  ansible.builtin.template: { src: daemon.json, dest: "{{ path[ansible_os_family] }}" }
  vars: { path: { Debian: /etc/docker/, Windows: /ProgramData/docker/config/ } }
  notify: [restart docker debian, restart docker windows]
- name: flush handlers
  ansible.builtin.meta: flush_handlers
