- name: "{{ domain.key }} volumes"
  ansible.builtin.include_tasks: volume.yml
  vars: { volume: "{{ item.volume }}" }
  when: item.type == 'volume'
  loop: "{{ domain.value.storage }}"
# TODO: this successfully updates configuration but does not error on uuid mismatch
#       it also reports config changed, how does it do that? is domain define different from pool define?
# TODO: config always changes due to autogenerated mac address
- name: domain
  community.libvirt.virt: { command: define, xml: "{{ lookup('template', 'domain.xml') }}" }
